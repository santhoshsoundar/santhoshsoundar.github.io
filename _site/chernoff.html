<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	  <meta name="author" content="Santhosh" />
    <meta name="description" content="my personal blog and resume">
    <link rel="favicon" href="static/img/favicon.ico">

<link rel="apple-touch-icon" sizes="57x57" href="static/img/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="static/img/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="static/img/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="static/img/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="static/img/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="static/img/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="static/img/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="static/img/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="static/img/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="static/img/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="static/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="static/img/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="static/img/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

    
      <title>Chernoff Faces - D3.js</title>
    

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha256-MfvZlkHCEqatNoGiOXveE8FIwMzZg4W85qfrfIFBfYc= sha512-dTfge/zgoMYpP7QbHy4gWMEGsbsdZeCXz7irItjcC3sPUFtf0kuFbDz/ixG7ArTxmDjLXDmezHubeNikyKGVyQ=="
    crossorigin="anonymous">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	<!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="static/css/main.css" />

	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" />
  <link rel="stylesheet" type="text/css" href="static/css/syntax.css" />
  <link href='https://fonts.googleapis.com/css?family=Raleway:400,200,500,300,100' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Oswald:300,400' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'>
    <!-- Google Analytics -->
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69391421-1', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <!-- Main Body-->
  <body>
  <!-- Wrap all page content here -->
  <div id="wrap">
    <!-- Navbar header -->
    <style>
.announce {
  padding: 15px 0;
  display: block;
  color: rgba(0, 0, 0, 0.8) !important;
  line-height: inherit;
  background: linear-gradient(to bottom, #ffc, #ffa);
  border-bottom: solid 1px rgba(0, 0, 0, 0.1);
}

.column {
  max-width: 960px;
  position: relative;
  display: block;
  margin: 0 auto;
  padding: 0 100px;
}
</style>

<a class='announce' href="https://santhoshsoundar.blog" target="blank">
  <div class='column'>This is an older version my blog, now a react based gatsby blog - <b>santhoshsoundar.blog</b></div>
</a>
<nav class="navbar-default">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html"><h1><i class="fa fa-home"></i>santhosh<span>fiddle</span></h1></a>

    </div>
    <div id="navbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="blog.html">Blog</a></li>
        <li><a href="https://github.com/Santhosh114">Projects</a></li>
        <li><a href="https://www.linkedin.com/in/santhoshsoundararajan">Resume</a></li>
      </ul>
    </div>
  </div>
</nav>         

    <div class="container">
	<div class="blog-post">
		<div class="col-sm-12"><h2>
		 <a href="/chernoff.html">Chernoff Faces - D3.js</a>
		</h2></div>
	</div>
	<div class="blog-title" style="margin-bottom:25px; float:left; width:100%;">
		<h5><div class="col-sm-3" style="text-align:left;">
		August 10, 2016
			
			</div>
			<div class="col-sm-9 tagsin">
			
			 
				#Chernoff_Faces  &nbsp;
			
			
			 
				#D3.js  &nbsp;
			
			
			 
				#SVG  &nbsp;
			
			
		    </div>


		</h5>
	</div>
	<div class="panel panel-default">
		<div class="panel-body">
			<div class="blogpost">
			  <style>
.container {
  width: auto;
  max-width: 800px;
  text-align: center;
}
.domain {
        fill: none;
        stroke: #777;
      }
.tick line{
    stroke: #777;
}
</style>

<div id="bars"></div>
<div id="faces"></div>
<script src="//code.jquery.com/jquery-2.0.0.js"></script>

<script src="//d3js.org/d3.v3.min.js"></script>

<h3 id="implementation"><a href="">Implementation:</a></h3>

<p>“Chernoff faces, invented by Herman Chernoff in 1973, display multivariate data in the shape of a human face.” ~Wiki</p>

<p>As we know, to visualise multivariate data, we resort to other visualization techniques such as <a href="http://www.infovis-wiki.net/index.php?title=Glyph">Glyphs</a>.</p>

<p>Chernoff faces are one such glyph that assign a bunch of variables at once via facial features like lips, eyes, and nose size etc.</p>

<p>Here is Chernoff implementation with pure D3.js.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">chernoffFaceRadiusRange</span><span class="o">=</span><span class="p">{</span><span class="na">min</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="na">max</span><span class="p">:</span><span class="mi">60</span> <span class="p">}</span>

<span class="kd">var</span> <span class="nx">chernoffFaceRadiusScale</span><span class="o">=</span><span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
                            <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="nx">salaryCompRange</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="nx">salaryRange</span><span class="p">.</span><span class="nx">max</span><span class="p">])</span>
                            <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="nx">chernoffFaceRadiusRange</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="nx">chernoffFaceRadiusRange</span><span class="p">.</span><span class="nx">max</span><span class="p">]);</span>
                            
<span class="kd">var</span> <span class="nx">chernoffFaceDIV</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s1">'#faces'</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span><span class="s2">"chernoffFaces"</span><span class="p">)</span>
  
<span class="kd">var</span> <span class="nx">chernoffFaceSVG</span><span class="o">=</span><span class="nx">chernoffFaceDIV</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'svg'</span><span class="p">)</span>        <span class="c1">// create an svg element</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'width'</span><span class="p">,</span> <span class="nx">svgWidth</span><span class="p">)</span> <span class="c1">// set its dimentions</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="nx">svgHeight</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">chernoffFaceHolder</span><span class="o">=</span><span class="nx">chernoffFaceSVG</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                             <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">salaryData</span><span class="p">)</span>
                             <span class="p">.</span><span class="nx">enter</span><span class="p">()</span>

 <span class="c1">//step 1.21 update cx, cy and r value for faces, leftEye and rightEye</span>
 <span class="kd">var</span> <span class="nx">faces</span><span class="o">=</span><span class="nx">chernoffFaceHolder</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span><span class="s2">"salary"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                            <span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span><span class="p">;</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                            <span class="k">return</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">salary</span><span class="p">)</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s2">"#b6baba"</span><span class="p">)</span>
 <span class="kd">var</span> <span class="nx">rightEyes</span><span class="o">=</span><span class="nx">chernoffFaceHolder</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span><span class="s2">"salaryA"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                            <span class="k">return</span> <span class="p">((</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span> <span class="o">-</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                             <span class="k">return</span> <span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                            <span class="k">return</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salaryA'</span><span class="p">])</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s2">"#e76020"</span><span class="p">)</span>
                        
 <span class="kd">var</span> <span class="nx">leftEyes</span><span class="o">=</span><span class="nx">chernoffFaceHolder</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'circle'</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span><span class="s2">"salaryB"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cx'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                           <span class="k">return</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span> <span class="o">+</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'cy'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                             <span class="k">return</span> <span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                        <span class="p">})</span> 
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                             <span class="k">return</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salaryB'</span><span class="p">])</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s2">"#ed9040"</span><span class="p">)</span>
                        
<span class="c1">//updating attribute "d"</span>
<span class="kd">var</span> <span class="nx">mouths</span><span class="o">=</span><span class="nx">chernoffFaceHolder</span>
                        <span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"class"</span><span class="p">,</span><span class="s2">"salaryC"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span>
                            <span class="nx">r</span><span class="o">=</span><span class="mi">0</span>
                            <span class="nx">start</span><span class="o">=</span><span class="s2">"M "</span>
                            <span class="nx">Ay</span><span class="o">=</span><span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                            <span class="nx">Ax</span><span class="o">=</span><span class="p">((</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span> <span class="o">-</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                            <span class="nx">Cy</span><span class="o">=</span><span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                            <span class="nx">Cx</span><span class="o">=</span> <span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span> <span class="o">+</span> <span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
                            
                            <span class="nx">By</span><span class="o">=</span><span class="p">((</span><span class="nx">svgHeight</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salary'</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="nx">chernoffFaceRadiusScale</span><span class="p">(</span><span class="nx">d</span><span class="p">[</span><span class="s1">'salaryC'</span><span class="p">])))</span>
                            <span class="nx">Bx</span><span class="o">=</span><span class="p">(</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nx">subChartWidth</span><span class="p">;</span>
                            
                            <span class="nx">d</span><span class="o">=</span><span class="nx">start</span><span class="o">+</span><span class="nx">Ax</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nx">Ay</span><span class="o">+</span><span class="s1">' Q '</span><span class="o">+</span><span class="nx">Bx</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nx">By</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nx">Cx</span><span class="o">+</span><span class="s1">' '</span><span class="o">+</span><span class="nx">Cy</span><span class="o">+</span><span class="s1">' '</span>
                            <span class="k">return</span> <span class="nx">d</span>
                        <span class="p">})</span>
                        <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="s1">'fill'</span><span class="p">,</span><span class="s2">"#31a354"</span><span class="p">)</span></code></pre></figure>

<script type="text/javascript">
var salaryData = 
            [{name:"A",dept:"IT",salaryA:1, salaryB:3, salaryC:2},
            {name:"B",dept:"HR",salaryA:1.5, salaryB:2, salaryC:3.5},
            {name:"C",dept:"HR",salaryA:1, salaryB:1, salaryC:1},
            {name:"D",dept:"IT",salaryA:1, salaryB:3, salaryC:1},
            {name:"E",dept:"SL",salaryA:1, salaryB:0.5, salaryC:3.5}
            ];
var listOfProjects=["salaryA","salaryB","salaryC"]

/////// HELPER FUNCTIONS  ////////////////////////////////////

function calculateTotalSalary(data,projectsList) {
//input a data and a list of project
//calculate the sum salary of all projects in the projectsList, and store it in the data under a field called “salary” 
  
  for (idx in data) {  // for every employee
    employee = data[idx];  // grab the employee
    // calculate their salary as a total of all project
    var salary=0
    for (p of projectsList){
        salary+=employee[p]
    }
    employee.salary = salary
  }
}
calculateTotalSalary(salaryData,listOfProjects);


  
function findDeptMean(data){
    //calculate mean salary of each department 
//return a dictionary of department means. 
 
    meansByDept={}
    for (d of data){//find all unique departments 
        meansByDept[d["dept"]]=undefined //temporarly set to undefined 
    };
    for (key in meansByDept){
        //using d3 helper function to get mean 
        meanValue=d3.mean(data,function(d){
        if(d['dept']==key){
            return d.salary 
        }
        })
        meansByDept[key]=meanValue
    }
    return meansByDept
}
meansByDept=findDeptMean(salaryData)


/// helper function to calculate over under
function addingOverunder(data){
    //calculate and add overunder information to the data
    for (d of data){
        d["overunder"]=d.salary-meansByDept[d.dept]
    }
}
addingOverunder(salaryData)

function findMinMaxRange(data,fieldName){
    var minValue=d3.min(data,function(d,i){
        return d[fieldName]
    })
    var maxValue=d3.max(data,function(d,i){
        return d[fieldName]
    })
    return ({"min":minValue,"max":maxValue})
}

var overunderRange=findMinMaxRange(salaryData,"overunder")
var salaryRange=findMinMaxRange(salaryData,"salary")

function findSalaryCompRange(data,projectList){
    var salaryCompRange={min:Number.POSITIVE_INFINITY, max:Number.NEGATIVE_INFINITY}
    for (project of projectList){
        var minMaxDict=findMinMaxRange(salaryData,project)
        if(minMaxDict.min<salaryCompRange.min){
            salaryCompRange.min=minMaxDict.min
        }
        if(minMaxDict.max>salaryCompRange.max){
            salaryCompRange.max=minMaxDict.max
        }
    }
    return salaryCompRange
}

var salaryCompRange=findSalaryCompRange(salaryData,listOfProjects)

//////////// END HELPER FUNCTIONS BASED ON LAST LAB /////////////////////////////


/////////////////settings for chart 
var svgWidth=800
var svgHeight=200 
var subChartWidth=svgWidth/salaryData.length

//////////////////plot bar charts/////////////////////
//settings for bar chart
var xStartLoc=35 //the left offset from canvas to the first bar 
var spaceBetweenBar=5
var yStartLoc=120 // the top offset from canvas to the bottom of the bar. 
var width=15 //width of bar 
var xLoc=width+spaceBetweenBar
var salaryCompHeightRange={min:0, max:100 }


var salaryCompHeightScale=d3.scale.linear()
                            .domain([salaryCompRange.min,salaryCompRange.max])
                            .range([ salaryCompHeightRange.min,salaryCompHeightRange.max]);

var salaryCompDIV = d3.select('#bars')
                        .attr("class","barCharts")
                        .attr("font-family","Arial")

                      
var salaryCompSVG=salaryCompDIV.append('svg')        // create an <svg> element
    .attr('width', svgWidth) // set its dimentions
    .attr('height', svgHeight)

var salaryCompG=salaryCompSVG.selectAll('rect')
                             .data(salaryData)
                             .enter()
function plotEachBar(colorOfBar,xStart,fieldName){
//this function will plot bars for a project, also label the bar. 
//return pointers to the bars and labels. 

    var barForSingleProject=salaryCompG
                        .append('rect')
                        .attr('class',fieldName)
                        .attr('x',function(d,i){
                            return xStartLoc+xStart+i*subChartWidth
                        })
                        .attr('y',function(d){
                            return yStartLoc-salaryCompHeightScale(d[fieldName]) 
                        })
                        .attr('height',function(d){
                            return salaryCompHeightScale(d[fieldName])
                        })
                        .attr('width',width)
                        .style('fill',colorOfBar)
    
    var labelForSinglePorject=salaryCompG.append('text')
                                         .text(fieldName.slice(-1))
                                         .attr('x',function(d,i){
                                            return xStartLoc+xStart+i*subChartWidth+5
                                        })
                                        .attr('y',yStartLoc+15)
                                        .attr("font-family","Arial")
                                        .attr("font-size","8pt");
     return (barForSingleProject,labelForSinglePorject)
}

colorList=["#e76020", "#ed9040", "#31a354", "#74c476"]
//draws bars for each project by looping through listOfProjects
for(i in listOfProjects){
    plotEachBar(colorList[i],i*(width+spaceBetweenBar),listOfProjects[i]) 
}
var salaryCompTitles=salaryCompG.append('text')
                                .text(function(d){
                                    return "Company "+d.name+" Salary" })
                                .attr('x',function(d,i){
                                    return xStartLoc/2+i*subChartWidth
                                })
                                .attr('y',yStartLoc+30)
                                .attr("font-size","8pt")
                                .attr("font-weight","Bold")
                                .style('fill', '#999');                   
///////////////////plot chernoff faces////////////
//set up svg
var chernoffFaceRadiusRange={min:0, max:60 }

var chernoffFaceRadiusScale=d3.scale.linear()
                            .domain([salaryCompRange.min, salaryRange.max])
                            .range([chernoffFaceRadiusRange.min, chernoffFaceRadiusRange.max]);
                            
var chernoffFaceDIV = d3.select('#faces')
                        .attr("class","chernoffFaces")
                        .attr("font-family","Arial")
  
var chernoffFaceSVG=chernoffFaceDIV.append('svg')        // create an <svg> element
    .attr('width', svgWidth) // set its dimentions
    .attr('height', svgHeight)

var chernoffFaceHolder=chernoffFaceSVG.selectAll('circle')
                             .data(salaryData)
                             .enter()

 //step 1.21 update cx, cy and r value for faces, leftEye and rightEye
 var faces=chernoffFaceHolder.append('circle')
                        .attr("class","salary")
                        .attr('cx',function(d,i){
                            return (i+1/2)*subChartWidth;
                        })
                        .attr('cy',svgHeight/2)
                        .attr('r',function(d,i){
                            return chernoffFaceRadiusScale(d.salary)
                        })
                        .style('fill',"#b6baba")
 var rightEyes=chernoffFaceHolder.append('circle')
                        .attr("class","salaryA")
                        .attr('cx',function(d,i){
                            return ((i+1/2)*subChartWidth - chernoffFaceRadiusScale(d['salary'])/2)
                        })
                        .attr('cy',function(d,i){
                             return svgHeight/2-chernoffFaceRadiusScale(d['salary'])/2
                        })
                        .attr('r',function(d,i){
                            return chernoffFaceRadiusScale(d['salaryA'])
                        })
                        .style('fill',"#e76020")
                        
 var leftEyes=chernoffFaceHolder.append('circle')
                        .attr("class","salaryB")
                        .attr('cx',function(d,i){
                           return (i+1/2)*subChartWidth + chernoffFaceRadiusScale(d['salary'])/2
                        })
                        .attr('cy',function(d,i){
                             return svgHeight/2 - chernoffFaceRadiusScale(d['salary'])/2
                        }) 
                        .attr('r',function(d,i){
                             return chernoffFaceRadiusScale(d['salaryB'])
                        })
                        .style('fill',"#ed9040")
                        
//step 1.3, updating attribute "d"
var mouths=chernoffFaceHolder
                        .append('path')
                        .attr("class","salaryC")
                        .attr('d',function(d,i){
                            r=0
                            start="M "
                            Ay=svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2
                            Ax=((i+1/2)*subChartWidth - chernoffFaceRadiusScale(d['salary'])/2)
                            Cy=svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2
                            Cx= (i+1/2)*subChartWidth + chernoffFaceRadiusScale(d['salary'])/2
                            
                            By=((svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2)+(chernoffFaceRadiusScale(d['salaryC'])))
                            Bx=(i+1/2)*subChartWidth;
                            
                            d=start+Ax+' '+Ay+' Q '+Bx+' '+By+' '+Cx+' '+Cy+' '
                            return d
                        })
                        .style('fill',"#31a354")
//step 1.3, add titles for each subchart. 
var chernoffTitle=chernoffFaceHolder.append('text')
                                .text(function(d){
                                    return "Company "+d.name+" Salary";
                                })
                                .attr('x',function(d,i){
                                       return (i+1/4)*subChartWidth-10;
                                })
                                .attr('y',(svgHeight/1.15))//your work here 
                                .attr("font-size","8pt")
                                .attr("font-weight","Bold")
                                .style('fill', '#999');


// ////////////////Part2 add data and update chart ///////////////////////

salaryD=[1,1.4,2,0,2.5,0]
//step 2.1 complete the following function that updates the data, ranges and scale. 
function updateDataRangeScale(project,projectData){
    if(listOfProjects.indexOf(project)==-1){//check if we have already added the project or not. 

        // adding salaryD to salaryData
        for(var i=0; i< salaryData.length; i++){
           var obj= salaryData[i];
           obj[project]=projectData[i];
        }

        // adding project to projectlist
        listOfProjects.push(project);

        // computing salary
        calculateTotalSalary(salaryData,listOfProjects);

        // computing depMean & updating overUnder
        meansByDept = findDeptMean(salaryData)
        addingOverunder(salaryData)

        overunderRange=findMinMaxRange(salaryData,"overunder")
        salaryRange=findMinMaxRange(salaryData,"salary")
        salaryCompRange=findSalaryCompRange(salaryData,listOfProjects)

        chernoffFaceRadiusScale.domain([salaryCompRange.min,salaryRange.max])
    } 
} 

duration=800
function updateFaces(){
    chernoffFaceDIV.selectAll("circle."+"salary")
                   .transition()
                   .duration(duration)
                   .attr('r',function(d,i){
                       return chernoffFaceRadiusScale(d.salary)
                   })
}
//Step 2.2
function updateLeftEyes(){
   //your work here 
   chernoffFaceDIV.selectAll("circle."+"salaryB")
                   .transition()
                   .duration(duration)
                   .attr('r',function(d,i){
                       return chernoffFaceRadiusScale(d['salaryB'])
                   })
                   .attr('cy',function(d,i){
                             return svgHeight/2 - chernoffFaceRadiusScale(d['salary'])/2
                        })
                    .attr('cx', function(d, i) {
                        return ((subChartWidth * i + subChartWidth / 2) + chernoffFaceRadiusScale(d.salary) / 2)
                         })
                    .attr('r',function(d,i){
                             return chernoffFaceRadiusScale(d['salaryB'])
                        })

}
function updateRightEyes(){
    //your work here 
    chernoffFaceDIV.selectAll("circle."+"salaryA")
                   .transition()
                   .duration(duration)
                   .attr('r',function(d,i){
                       return chernoffFaceRadiusScale(d['salaryA'])
                   })
                   .attr('cy',function(d,i){
                             return svgHeight/2-chernoffFaceRadiusScale(d['salary'])/2
                        })
                    .attr('cx', function(d, i) {
                     return ((subChartWidth * i + subChartWidth / 2) - chernoffFaceRadiusScale(d.salary) / 2)
                    })
                   .attr('r',function(d,i){
                            return chernoffFaceRadiusScale(d['salaryA'])
                        })
}




function updateMouths(){
    //your work here 
    chernoffFaceDIV.selectAll("path."+"salaryC")
                   .transition()
                   .duration(duration)
                   .attr('d',function(d,i){
                            r=0
                            start="M "
                            Ay=svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2
                            Ax=((i+1/2)*subChartWidth - chernoffFaceRadiusScale(d['salary'])/2)
                            Cy=svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2
                            Cx= (i+1/2)*subChartWidth + chernoffFaceRadiusScale(d['salary'])/2
                            
                            By=((svgHeight/2+chernoffFaceRadiusScale(d['salary'])/2)+(chernoffFaceRadiusScale(d['salaryC'])))
                            Bx=(i+1/2)*subChartWidth;
                            
                            d=start+Ax+' '+Ay+' Q '+Bx+' '+By+' '+Cx+' '+Cy+' '
                            return d
                        })
}

//Step 2.3 add salaryAsNoses 
function addNoses(){
    var noses=chernoffFaceHolder
                        .append('ellipse')
                        .attr("class","salaryD")
                        .attr('cx',function(d,i){
                             return (i+1/2)*subChartWidth;
                        })
                        .attr('cy',svgHeight/2)
                        .attr('rx',function(d){
                             return 0
                        })//set to zero to add animation
                        .attr('ry',function(d){
                             return 0
                        })//set zerion to add animation
                        .style('fill',"#74c476")
        noses.transition()
             .duration(duration)
             .attr('rx',function(d){
                           return chernoffFaceRadiusScale(d['salaryD']) 
                        })
             .attr('ry',function(d){
                            return chernoffFaceRadiusScale(d['salaryD'])/2
                        })
                       
}

function mouseEventForNose() {
    chernoffFaceDIV.selectAll("ellipse")
        .on("mouseover", handleMouseOver)
        .on("mouseout", handleMouseOut)
        .on("mousemove", handleMouseMove)

}

function update(){
    updateDataRangeScale('salaryD',salaryD)
    updateFaces()
    updateLeftEyes()
    updateRightEyes()
    updateMouths()
    addNoses()
    mouseEventForNose()
    addSalaryDbars()
    mouseEventForBarChart()
}
                
chernoffButton=chernoffFaceDIV
                .append("button")
                .text("Add new feature to data!")
                .attr("type","button")
                .attr("value","Update Data")
                .attr("onclick","update()")
                .style("height",40)
                .style("width",90)

///////////////////Part3 tooltip /////////////////   
var chernoffTips=chernoffFaceDIV.append("div")
                                .attr("class",'tooltip')
                                .style("display","none")
                                .style('position',"absolute")
                                .style("fill","black")
function handleMouseOver(d,i){
    chernoffTips.style("display","inline")             
}
function handleMouseMove(d,i){
    fieldName=d3.select(this).attr('class')
    chernoffTips.text(d.name+" "+fieldName+": "+d[fieldName])
      .style("left", (d3.event.pageX - 34) + "px")
      .style("top", (d3.event.pageY - 12) + "px")
      .style("color","black");
}
function handleMouseOut(d,i){
     chernoffTips.style("display", "none");
}

chernoffFaceDIV.selectAll("circle")
      .on("mouseover", handleMouseOver)
      .on("mouseout",handleMouseOut)
      .on("mousemove", handleMouseMove)
chernoffFaceDIV.selectAll("path")
      .on("mouseover",handleMouseOver)
      .on("mouseout",handleMouseOut)
      .on("mousemove", handleMouseMove)  
              
 ///////////part 3 end////////////////
 //////part 4////////
 //step 4.1 compelete the following function 
 // Hint if you use the helper function plotEachBar(), this can be done with one line of code 
 //Call this function in update()
function addSalaryDbars(){
    plotEachBar(colorList[3], 3 * (width + spaceBetweenBar), listOfProjects[3])
}
//step 4.2 adding axis  
var yAxisScale=d3.scale.linear()
                            .domain([salaryCompRange.min,salaryCompRange.max])
                            .range([ salaryCompHeightRange.max,salaryCompHeightRange.min])

var yAxis = d3.svg.axis()
                  .scale(yAxisScale)
                  .orient("left")
                  
salaryCompG.append('g')
            .call(yAxis)
            .attr('transform',function(d,i){
                return 'translate(' + (30 + i * subChartWidth) + ',' + 20 + ')'
            });
//step 4.3 adding tooltips for bar charts 
var barToolTip = salaryCompDIV.append("div")
    .attr("class", 'tooltip')
    .style("display", "inline")
    .style('position', "absolute")
    .style("fill", "black")

function handleMouseOver(d, i) {
    barToolTip.style("display", "inline")
}

function handleMouseMove(d, i) {
    fieldName = d3.select(this).attr('class')
    barToolTip.text(d.name + " " + fieldName + ": " + d[fieldName])
        .style("left", (d3.event.pageX - 34) + "px")
        .style("top", (d3.event.pageY - 12) + "px")
        .style("color", "black");
}

function handleMouseOut(d, i) {
    barToolTip.style("display", "none");
}


function mouseEventForBarChart() {
    salaryCompDIV.selectAll("rect")
        .on("mouseover", handleMouseOver)
        .on("mouseout", handleMouseOut)
        .on("mousemove", handleMouseMove)
}
mouseEventForBarChart();   

</script>


			   <!--<hr>-->
			   <!--<div class="related-posts">
				   <h5>Related Posts</h5>
				   
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	September  5, 2017
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="/equinixChallenge.html">Equinix Data Viz Challenge - Magneto</a></strong>
								 </h6>
							 </div>
						</div>
					
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	August 22, 2017
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="/expdashboard.html">Expenditure Dashboard</a></strong>
								 </h6>
							 </div>
						</div>
					
						<div class="row">
							 <div class="col-sm-4 col-md-4 col-lg-4">
								 <h6 style="text-align: right">
								 	July 18, 2016
								 </h6>
							 </div>
							 <div class="col-sm-8 col-md-8 col-lg-8">
								 <h6 style="text-align: left">
								 	<strong><a href="/parallel.html">Parallel Coordinates - The Rockstar InfoViz</a></strong>
								 </h6>
							 </div>
						</div>
					
			   </div>-->
			</div>
		</div>
	</div>
	<!--
<div class="disqus">
<div id="disqus_thread"></div>
<script type="text/javascript">
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		var disqus_shortname = 'username'; // required: replace example with your forum shortname
		var disqus_identifier = '/chernoff.html';
		var disqus_url = 'http://santhosh114.github.io//chernoff.html';
 
            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

-->
</div>


  </div>
  <!-- Footer -->
  <footer>
    
    <div id="footer">
        
        <div class="container">

            <p class="text-muted">Powered by <a href="http://jekyllrb.com/">Jekyll</a> and
            <a href="https://github.com/Santhosh114">GitHub</a> with ♥ Santhosh Soundararajan</p>
            
        </div>
    </div>
</footer>
<div class="footer"></div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"
    integrity="sha256-Sk3nkD6mLTMOF0EOpNtsIry+s1CsaqQC1rVLTAy+0yc= sha512-K1qjQ+NcF2TYO/eI3M6v8EiNYZfA95pQumfvcVrTHtwQVDG+aHRqLi/ETn2uB+1JqwYqVG3LIvdm9lj6imS/pQ=="
    crossorigin="anonymous"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="static/js/docs.min.js"></script>
    <script src="static/js/main.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="static/js/ie10-viewport-bug-workaround.js"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75622536-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
